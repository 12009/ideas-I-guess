## 深入理解Java虚拟机

[TOC]



### 如何阅读这本书

- 这本书的特点就是内容特别无聊
- 所以为了能看下去必须用问题驱动的方法



### 虚拟机结构相关问题

#### 描述一下java内存区域

- 程序计数器
  - 较小的内存空间
  - 线程所执行的字节码的行号指示器
  - 线程私有
  - 执行java方法，记录字节码指令地址
  - 执行native，记录值为空
- java虚拟机栈
  - 线程私有
  - 生命周期=线程
  - 结构：栈帧（stack frame）
  - 栈帧
    - 局部变量表：基本数据类型和对象引用
    - 操作数栈
    - 动态链接
    - 方法出口信息
  - 栈过深，容易StackOverflowError
  - 栈内存过大容易：OutOfMemoryError
- 本地方法栈
  - 执行native 方法
  - 其余类似java虚拟机栈
- Java堆
  - 内存中最大的一块
  - 存放对象实例
  - 垃圾收集器主要管理的区域
  - 新生代，老年代：eden , from survivor , to survivor 
  - 线程共享私有的分配缓冲区（Thread Local Allocation Buffer,TLAB）
  - Xmx Xms控制
- 方法区
  - 线程共享的内存区域
  - 存储已被虚拟机加载的类信息，常量，静态变量，即时编译器编译后的代码
  - 也叫永久代
- 运行时常量池
  - 方法区的一部分
  - 存放各种字面量和符号引用
- 直接内存
  - 不受java虚拟机堆限制，受本机内存限制
  - 为NIO快速读写而设计的



#### 对象的结构

- 

#### 如何解决OOM异常

- 什么是OOM
- Java堆溢出
- 虚拟机栈和本地方法栈溢出
- 方法去和运行时常量池溢出
- 本机直接内存溢出



#### 简述一下垃圾收集器





#### 如何监控虚拟机





#### 如何优化虚拟机









### 虚拟机执行相关问题





### Java编译器相关问题