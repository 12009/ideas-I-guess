## 说明

- 直接看书看不下去
- 只有边看边做笔记才有效率

[TOC]



## 架构分析

- 



## 日志采集

### 浏览器采集过程



#### 页面浏览日志采集流程



#### 页面交互日志采集



#### 页面日志的清洗和预处理



### 无线客户端采集过程

- 阿里巴巴内部使用UserTrack的SDK采集
- 用户的行为通过“事件”这一概念来描述，也作为程序处理的基本单位

#### 页面事件

#### 控件点击及其他事件

#### 特殊场景

#### 遇到的问题

##### app应用繁多

##### 设备的不同

##### 传输的透明性

#### 现阶段的挑战

## 数据同步

### 同步类型

- 直连同步
- 数据文件同步
- 数据库日志解析同步

### 直连同步

- 规范的接口API
- 动态链接库的方式连接业务库
- 因为所有类型数据库全部根据统一的api作为接口，所以比较容易转移业务

### 数据文件同步

- 定义好文件编码，大小，格式。
- 多个不同类型全部读写到一个文件服务器
- 然后在统一上传，下载，进行管理
- 可以包含一个校验文件，记录数据量大小，和数据同步准确行

### 数据库日志解析同步

- 日志文件的系统恢复用来记录数据库的操作
- 操作有：增删改查
- 所以一条记录用同一个主键，但是操作类型不一样或者说执行流程不一样。需要进行一个去重处理
  - 不过滤删除流水
  - 过滤最后一天删除流水
  - 过滤删除流水和之前的流水



### 现阶段问题

- 数据延迟
- 日志分析难度较大耗时间
- 数据漂移和遗漏，如零点的时候的增量表，该如何处理



## 阿里数据同步的解决方案

- 可以处理多样化的数据来源，各种数据库
- 处理数据量大，可以达到EB级别，同步数据达到PB级别

### 批量数据同步

- 

